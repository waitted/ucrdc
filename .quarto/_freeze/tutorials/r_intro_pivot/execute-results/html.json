{
  "hash": "f606116fe1a0d7b68c1e652765457add",
  "result": {
    "engine": "knitr",
    "markdown": "---\nlayout: page\ntitle: \"Pivoting: data in wide and long format\"\ndate: \"Last updated: 2025-08-17\"\n---\n\n\n\n\n## Introduction\n\nTabular data can be stored in different formats. In tidy data, every row is an observation and every column is a variable. But depending on what you define as your observations and variables, you might need to pivot your data from wide to long format or vice versa.\n\nThis tutorial introduces the concepts of long and wide format, and shows you how to use the `pivot_longer()` and `pivot_wider()` functions from `tidyverse` on the `population` dataset (which comes pre-loaded with `tidyverse` so you don't need to import it).\n\nLet's load the `tidyverse` package and have a look at the `population` dataset:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load tidyverse\nlibrary(tidyverse)\n\n# add diamonds to the environment\ndata(population)\n```\n:::\n\n\n## Long and wide format\n\nCompare the following two simple datasets:\n\nData A:\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n| year|country  | value|\n|----:|:--------|-----:|\n| 2022|countryA |    10|\n| 2022|countryB |    12|\n| 2023|countryA |    14|\n| 2023|countryB |    15|\n\n\n:::\n:::\n\n\nData B:\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n| year| countryA| countryB|\n|----:|--------:|--------:|\n| 2022|       10|       12|\n| 2023|       14|       15|\n\n\n:::\n:::\n\n\nData A is in long format, and Data B is in wide format. The tables contain the same information, but sometimes one format is more convenient than the other.\n\nYou can convert between these two forms using the `pivot_longer()` (wide to long) and `pivot_wider()` (long to wide) functions. To use `pivot_longer()` you need to specify which columns you'd like to turn into a single column: e.g. to go from Data B to Data A, you'd use the argument `cols = c(countryA, countryB)` (or equivalently, `cols = -year`). To use `pivot_wider()`, you need to specify which column to use for variable names, and which column for variable values: going from Data A to Data B would use the arguments `names_from = country, values_from = value`.\n\n## Pivoting on the `population` data\n\nThe `population` dataset contains the population of different countries over time. Currently it is in long format: the identifying variables are `country` and `year`, and the variable of interest is `population`.\n\nWe can convert it to wide format where the unit of observation is the country, and we have different variables for the population in every year.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# convert the data to wide format with country as the unit of observation\npivot_wider(population, names_from = year, values_from = population)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 219 × 20\n   country `1995` `1996` `1997` `1998` `1999` `2000` `2001` `2002` `2003` `2004`\n   <chr>    <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>\n 1 Afghan… 1.76e7 1.84e7 1.90e7 1.95e7 2.00e7 2.06e7 2.13e7 2.22e7 2.31e7 2.40e7\n 2 Albania 3.36e6 3.34e6 3.33e6 3.33e6 3.32e6 3.30e6 3.29e6 3.26e6 3.24e6 3.22e6\n 3 Algeria 2.93e7 2.98e7 3.03e7 3.08e7 3.13e7 3.17e7 3.22e7 3.26e7 3.30e7 3.35e7\n 4 Americ… 5.29e4 5.39e4 5.49e4 5.59e4 5.68e4 5.75e4 5.82e4 5.87e4 5.91e4 5.93e4\n 5 Andorra 6.39e4 6.43e4 6.41e4 6.38e4 6.41e4 6.54e4 6.80e4 7.16e4 7.56e4 7.91e4\n 6 Angola  1.21e7 1.25e7 1.28e7 1.31e7 1.35e7 1.39e7 1.44e7 1.49e7 1.54e7 1.60e7\n 7 Anguil… 9.81e3 1.01e4 1.03e4 1.05e4 1.08e4 1.11e4 1.14e4 1.17e4 1.20e4 1.23e4\n 8 Antigu… 6.83e4 7.02e4 7.22e4 7.42e4 7.60e4 7.76e4 7.90e4 8.00e4 8.09e4 8.17e4\n 9 Argent… 3.48e7 3.53e7 3.57e7 3.61e7 3.65e7 3.69e7 3.73e7 3.76e7 3.80e7 3.83e7\n10 Armenia 3.22e6 3.17e6 3.14e6 3.11e6 3.09e6 3.08e6 3.06e6 3.05e6 3.04e6 3.03e6\n# ℹ 209 more rows\n# ℹ 9 more variables: `2005` <dbl>, `2006` <dbl>, `2007` <dbl>, `2008` <dbl>,\n#   `2009` <dbl>, `2010` <dbl>, `2011` <dbl>, `2012` <dbl>, `2013` <dbl>\n```\n\n\n:::\n:::\n\n\nAlternatively, we can say that the unit of observation is the year, and we have different variables for the population in every country in that year.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# convert the data to wide format with year as the unit of observation\npivot_wider(population, names_from = country, values_from = population)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 19 × 220\n    year Afghanistan Albania  Algeria `American Samoa` Andorra   Angola Anguilla\n   <dbl>       <dbl>   <dbl>    <dbl>            <dbl>   <dbl>    <dbl>    <dbl>\n 1  1995    17586073 3357858 29315463            52874   63854 12104952     9807\n 2  1996    18415307 3341043 29845208            53926   64274 12451945    10063\n 3  1997    19021226 3331317 30345466            54942   64090 12791388    10305\n 4  1998    19496836 3325456 30820435            55899   63799 13137542    10545\n 5  1999    19987071 3317941 31276295            56768   64084 13510616    10797\n 6  2000    20595360 3304948 31719449            57522   65399 13924930    11071\n 7  2001    21347782 3286084 32150198            58176   68000 14385283    11371\n 8  2002    22202806 3263596 32572977            58729   71639 14886574    11693\n 9  2003    23116142 3239385 33003442            59117   75643 15421075    12023\n10  2004    24018682 3216197 33461345            59262   79060 15976715    12342\n11  2005    24860855 3196130 33960903            59117   81223 16544376    12637\n12  2006    25631282 3179573 34507214            58652   81877 17122409    12903\n13  2007    26349243 3166222 35097043            57919   81292 17712824    13145\n14  2008    27032197 3156608 35725377            57053   79969 18314441    13365\n15  2009    27708187 3151185 36383302            56245   78659 18926650    13571\n16  2010    28397812 3150143 37062820            55636   77907 19549124    13768\n17  2011    29105480 3153883 37762962            55274   77865 20180490    13956\n18  2012    29824536 3162083 38481705            55128   78360 20820525    14132\n19  2013    30551674 3173271 39208194            55165   79218 21471618    14300\n# ℹ 212 more variables: `Antigua and Barbuda` <dbl>, Argentina <dbl>,\n#   Armenia <dbl>, Aruba <dbl>, Australia <dbl>, Austria <dbl>,\n#   Azerbaijan <dbl>, Bahamas <dbl>, Bahrain <dbl>, Bangladesh <dbl>,\n#   Barbados <dbl>, Belarus <dbl>, Belgium <dbl>, Belize <dbl>, Benin <dbl>,\n#   Bermuda <dbl>, Bhutan <dbl>, `Bolivia (Plurinational State of)` <dbl>,\n#   `Bonaire, Saint Eustatius and Saba` <dbl>, `Bosnia and Herzegovina` <dbl>,\n#   Botswana <dbl>, Brazil <dbl>, `British Virgin Islands` <dbl>, …\n```\n\n\n:::\n:::\n\n\nThese different formats can be useful for different types of analysis.\n\nTo be able to work with this new dataset, you need to save it to a new object. Let's assign the result of the `pivot_wider()` function (with countries as the unit) to a new object called `population_wide`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# save the result to a new object\npopulation_wide <- pivot_wider(population, names_from = year, values_from = population)\n```\n:::\n\n\nPivoting is reversible, so we can convert `population_wide` back to long format with the `pivot_longer()` function. We want to take the years as the variable names, and the population as the values -- instead of listing all years as the columns we want to convert, we can say that we want to pivot all columns except `country`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# convert the data back to long format\npivot_longer(population_wide, cols = -country, names_to = \"year\", values_to = \"population\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4,161 × 3\n   country     year  population\n   <chr>       <chr>      <dbl>\n 1 Afghanistan 1995    17586073\n 2 Afghanistan 1996    18415307\n 3 Afghanistan 1997    19021226\n 4 Afghanistan 1998    19496836\n 5 Afghanistan 1999    19987071\n 6 Afghanistan 2000    20595360\n 7 Afghanistan 2001    21347782\n 8 Afghanistan 2002    22202806\n 9 Afghanistan 2003    23116142\n10 Afghanistan 2004    24018682\n# ℹ 4,151 more rows\n```\n\n\n:::\n:::\n\n\nThe `names_to` and `values_to` arguments are used to specify the names of the new columns that will be created; they are optional, but can be useful for clarity.\n\n## Video tutorial TBA\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}