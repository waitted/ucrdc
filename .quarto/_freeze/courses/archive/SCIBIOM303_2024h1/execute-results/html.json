{
  "hash": "106778f7f24894689f9cd549d834c972",
  "result": {
    "engine": "knitr",
    "markdown": "---\nlayout: page\ntitle: \"SCIBIOM303\\nMechanisms of Disease\"\nsubtitle: \"Spring 2024\"\ndate: \"Last updated: 2025-08-17\"\n---\n\n\n\n\n# Introduction\n\nIn this project we investigate the relationship between COVID-19 cases and the Stringency index of COVID regulations in different countries by making a scatter plot and calculating the correlation between the two variables.\n\nThe R script from the workshop is also available on [GitHub](https://github.com/ucrdatacenter/projects/blob/main/SCIBIOM303/2024h1/workshop_code.R).\n\nThe first step of making the map is to (install and) load the required libraries.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# install.packages(\"tidyverse\")\n# install.packages(\"corrr\")\nlibrary(tidyverse)\nlibrary(corrr)\n```\n:::\n\n\n# Data\n\nWe need to load the data for the stringency index per country, together with the number of COVID-19 cases and the total population of each country.\n\nFirst we load and tidy the data for stringency.\\\nThe data for the stringency was obtained from [Our World in Data](https://ourworldindata.org/covid-stringency-index#:~:text=The%20stringency%20index%20is%20a,100%20(100%20%3Dstrictest)). You can load the data directly from the link below, therefore you don't need to download the file.\n\nThe raw data has observations for every day, so to get a single number per country, we group the data by country and calculate the mean stringency index within each country.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load the data for the stringency index and assign it to the object containment\ncontainment <- read_csv(\"https://github.com/ucrdatacenter/projects/raw/main/SCIBIOM303/2024h1/covid-containment-and-health-index.csv\") |> \n  # group the data by country code\n  group_by(Code) |> \n  # calculate the mean stringency index per country\n  summarise(avg_containment = mean(containment_index, na.rm = TRUE))\n```\n:::\n\n\nThe data for the number of COVID cases are also from [Our World in Data](https://ourworldindata.org/covid-cases).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load the data for the number of COVID cases and assign it to the object covid\ncovid <- read_csv(\"https://github.com/ucrdatacenter/projects/raw/main/SCIBIOM303/2024h1/owid-covid-data.csv\")\n```\n:::\n\n\nThe `covid` dataset reports the number of COVID cases (and many other variables) every week, so to get a single number of total cases per country, we sum up the weekly new cases per country.\n\nTo add the stringency measure for each country next to the COVID cases, we join the data together using the `inner_join` function. This function takes two dataframes and joins them together based on a common column, in this case `Code`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create a new dataframe merged_data that contains both variables\nmerged_data <- covid |> \n  # rename the column iso_code to Code\n  rename(Code = iso_code) |> \n  # group the data by country code\n  group_by(Code) |> \n  # calculate the mean number of new cases per million people per country\n  summarise(avg_new_cases_per_million = mean(new_cases_per_million, na.rm = TRUE)) |> \n  # join the data with the containment data\n  inner_join(containment, by = \"Code\")\n```\n:::\n\n\n# Scatterplot and correlation\n\nWe can make a scatter plot of the relationship between the stringency index and the number of COVID cases per million people to visualize the relationship. We add a linear regression line to the scatter plot to see the trend more clearly and customize the axis labels and theme.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmerged_data |> \n  # define a plot with the containment index on the x-axis and the number of new cases per million on the y-axis\n  ggplot(aes(x = avg_containment, y = avg_new_cases_per_million)) +\n  # add points for each country\n  geom_point() +\n  # add a linear regression line\n  geom_smooth(method=\"lm\") +\n  # add labels to the axes and a title\n  labs(title = \"COVID-19 Cases vs Containment Index: 185 countries over 2020-2022\",\n       y = \"Average weekly new cases per million inhabitants\",\n       x = \"Average containment index\") +\n  # customize the theme\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](SCIBIOM303_2024h1_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nFinally, we calculate the correlation matrix between the variables.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# calculate the correlation matrix\nmerged_data |> \n  correlate()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 Ã— 3\n  term                      avg_new_cases_per_million avg_containment\n  <chr>                                         <dbl>           <dbl>\n1 avg_new_cases_per_million                   NA               0.0741\n2 avg_containment                              0.0741         NA     \n```\n\n\n:::\n:::\n",
    "supporting": [
      "SCIBIOM303_2024h1_files\\figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}