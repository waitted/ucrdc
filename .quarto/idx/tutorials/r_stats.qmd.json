{"title":"Statistics in R","markdown":{"yaml":{"layout":"page","title":"Statistics in R","date":"Last updated: `r Sys.Date()`"},"headingText":"Introduction","containsRefs":false,"markdown":"\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, error = FALSE)\n```\n\n\nThis document provides an overview of the basic statistical functions in R, including descriptive statistics and summary tables.\n\nThis tutorial shows you examples of using statistical methods on the `diamonds` dataset, which comes pre-loaded with the `tidyverse` package.\n\nLet's load the `tidyverse` package and have a look at the `diamonds` dataset:\n\n```{r, eval = FALSE}\nlibrary(tidyverse)\ndata(diamonds)\n```\n\n# Descriptive statistics\n\n## Summaries in the R Console\n\nTo get a descriptive statistic of a single variable in a tibble, we can use that variable as an argument to a relevant function (using `$` to refer to a variable in a tibble).\n\n```{r, eval = FALSE}\nmean(diamonds$price)\nmedian(diamonds$price)\nsd(diamonds$price)\n```\n\nTo get the frequencies of a categorical variable, we can use the `count()` function, with the `sort = TRUE` argument returning the values in descending frequency. `count()` is a tidy function that works well with pipe workflows and can count the joint frequencies of multiple variables.\n\n```{r, eval = FALSE}\n# frequencies of a single variable\ncount(diamonds, cut)\n\n# joint frequency distribution\ncount(diamonds, cut, color)\n```\n\nTo get the correlation coefficient between two variables, we can use the `cor()` function in the same way we used other descriptives such as `mean()`.\n\n```{r, eval = FALSE}\ncor(diamonds$price, diamonds$carat)\n```\n\nThe easiest way to get summary statistics of all variables in a tibble is with the `summary()` function: this function shows the distribution of numeric variables, the frequencies of categorical variables, and the number of missing values for each variable.\n\n```{r, eval = FALSE}\nsummary(diamonds)\n```\n\n## Publication-ready summaries with `gtsummary`\n\nThe `summary()` function is useful for viewing the data in the Console, but doesn't export to outside of R nicely. There are a few packages available for generating simple summary statistics tables that contain information about the central tendencies and dispersion of the data that also export nicely, such as `gtsummary`.\n\n```{r, eval = FALSE}\nlibrary(gtsummary)\n\n# tbl_summary() creates a summary table of the data\ntbl_summary(diamonds)\n```\n\nYou can stratify your summary by a grouping variable using the `by` argument:\n\n```{r, eval = FALSE}\ntbl_summary(diamonds, by = cut)\n\n# add p-value of difference between groups\ntbl_summary(diamonds, by = cut) |> \n  add_p()\n```\n\nYou can also customize the appearance of the table.\n\n```{r, eval = FALSE}\ntbl_summary(diamonds, by = cut) |> \n  modify_header(label ~ \"Variable\") |> \n  modify_caption(\"Summary Table by Cut\")\n```\n\nTo export the table as a Word document, use the `gtsave()` function. Note that we first use the `as_gt()` function to convert the `tbl_summary()` output to a `gt` object, and load the `gt` package in order to use the Word export function defined for the `gt` package.\n\n```{r, eval=FALSE}\nlibrary(gt)\n\ntbl_summary(diamonds, by = cut) |> \n  as_gt() |> \n  gtsave(\"summary_table.docx\")\n```\n\nIf you use LaTeX, you can also export as a LaTeX table, also relying on the `gt` package.\n\n```{r, eval=FALSE}\ntbl_summary(diamonds, by = cut) |> \n  as_gt() |> \n  gtsave(\"summary_table.tex\")\n```\n\n# Hypothesis testing\n\nMost of the simple statistical tests are from base R, so they don't rely on tidy principles, but many are compatible with tidy workflows to at least some extent. In the following we'll cover some of the key methods that show up in methods and statistics courses at UCR. In addition, the `tidy()` function from the `broom` package converts most text output into simple tibbles, which are useful for exporting and visualizing results.\n\n```{r, eval = FALSE}\nlibrary(broom)\n```\n\n## t-tests\n\nWe can run one and two samples t-tests to evaluate group means with the `t.test()` function. The function supports various options and model specifications: a simple one-sample t-test only requires specifying the variable of interest, either with `x = data$variable` or `x = variable, data = data` syntax. For two-sample t-tests, we can use the formula syntax `y ~ x` to specify the dependent and independent variables or the `x` and `y` (and optionally `data`) arguments. Additional options include specifying the alternative hypothesis, the confidence level, the value of $\\mu$, and whether we want a paired t-test and assume equal variances. Helper functions such as `tidy()` convert the Console output to an easy-to-export tibble of results.\n\nTo demonstrate two-sample t-tests, we define a subset of the data that contains only two possible values of `cut`.\n\n```{r, eval = FALSE}\n# simple t-test (H0: mean=mu)\nt.test(diamonds$carat, mu = 1)\n\n# define data subsample of fair and good diamonds to have only two groups of cut\ndiamonds_sub <- diamonds |> \n  filter(cut %in% c(\"Fair\", \"Good\"))\n\n# can also use data argument instead of data$...\n# price ~ cut is formula specification: variable ~ group\n# H0: fair and good diamonds have the same average price\nt.test(price ~ cut, alternative = \"greater\", data = diamonds_sub)\n\n# tidy() function turns results into a tibble\nt.test(price ~ cut, alternative = \"greater\", data = diamonds_sub) |> tidy()\n```\n\n## Correlation test\n\nThe `cor.test()` function calculates the correlation between two variables. Again, the function supports various specifications: `x` and `y` arguments, formula syntax (see below for an example), and the `data` argument.\n\n```{r, eval = FALSE}\ncor.test( ~ price + carat, data = diamonds)\n\n# tidy() function turns results into a tibble\ncor.test( ~ price + carat, data = diamonds) |> tidy()\n```\n\n## Simple regression\n\nA key building block of statistical analysis is linear regression. The `lm()` function fits a linear model to the data, with a wide range of specifications, passed as the formula argument (first argument if unnamed). The formula syntax is `y ~ x`, where `y` is the dependent variable and `x` is the independent variable. Again, optional function arguments allow for a lot of customization, but the default settings are sufficient for most applications. Helper functions such as `tidy()` and `summary()` provide extensive summaries of the model fit and coefficients, and `tbl_regression()` from the `gtsummary` package creates neat tables of the results. Assigning the result of a model to an object saves computational time, as then we can work with the results without having to re-run the analysis every time.\n\n```{r, eval = FALSE}\n# assign outcome to object\nfit <- lm(price ~ carat, data = diamonds)\n\n# extensive result summary\nfit |> summary()\n\n# tidy coefficients\nfit |> tidy()\n\n# display-ready table with gtsummary\ntbl_regression(fit)\n```\n\n## Multiple regression\n\nMultiple regression extends simple regression to multiple independent variables. The only difference is the formula specification, which now connects multiple independent variables with `+` signs. The formula specification also allows for interactions between variables, which can be specified with `*` (if the main effects should be included) or `:` (for only the interaction term). The `DV ~ .~` syntax includes all variables in the data except the dependent variable as independent variables.\n\n```{r, eval = FALSE}\nlm(price ~ x + y + z + table + depth, data = diamonds) |> summary()\n\n# all variables in data\nlm(price ~ ., data = diamonds) |> summary()\n\n# interactions\nlm(price ~ x * y, data = diamonds) |> summary()\n```\n\n## ANOVA\n\nAnalysis of variance (ANOVA) is a generalization of the t-test to multiple groups. The `aov()` function fits an ANOVA model to the data, with the formula syntax `y ~ x`, where `y` is the dependent variable and `x` is the independent variable. The same helper functions as with `lm()` can be used to summarize the results.\n\nNote that ANOVA is a specific case of a linear regression model, so the results are equivalent to those of a linear regression model with a categorical independent variable.\n\n```{r, eval = FALSE}\nanova_fit <- aov(price ~ cut, data = diamonds)\n\nsummary(anova_fit)\ntidy(anova_fit)\n\n# equivalent regression\nlm(price ~ cut, data = diamonds) |> summary()\n```\n","srcMarkdownNoYaml":"\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, error = FALSE)\n```\n\n# Introduction\n\nThis document provides an overview of the basic statistical functions in R, including descriptive statistics and summary tables.\n\nThis tutorial shows you examples of using statistical methods on the `diamonds` dataset, which comes pre-loaded with the `tidyverse` package.\n\nLet's load the `tidyverse` package and have a look at the `diamonds` dataset:\n\n```{r, eval = FALSE}\nlibrary(tidyverse)\ndata(diamonds)\n```\n\n# Descriptive statistics\n\n## Summaries in the R Console\n\nTo get a descriptive statistic of a single variable in a tibble, we can use that variable as an argument to a relevant function (using `$` to refer to a variable in a tibble).\n\n```{r, eval = FALSE}\nmean(diamonds$price)\nmedian(diamonds$price)\nsd(diamonds$price)\n```\n\nTo get the frequencies of a categorical variable, we can use the `count()` function, with the `sort = TRUE` argument returning the values in descending frequency. `count()` is a tidy function that works well with pipe workflows and can count the joint frequencies of multiple variables.\n\n```{r, eval = FALSE}\n# frequencies of a single variable\ncount(diamonds, cut)\n\n# joint frequency distribution\ncount(diamonds, cut, color)\n```\n\nTo get the correlation coefficient between two variables, we can use the `cor()` function in the same way we used other descriptives such as `mean()`.\n\n```{r, eval = FALSE}\ncor(diamonds$price, diamonds$carat)\n```\n\nThe easiest way to get summary statistics of all variables in a tibble is with the `summary()` function: this function shows the distribution of numeric variables, the frequencies of categorical variables, and the number of missing values for each variable.\n\n```{r, eval = FALSE}\nsummary(diamonds)\n```\n\n## Publication-ready summaries with `gtsummary`\n\nThe `summary()` function is useful for viewing the data in the Console, but doesn't export to outside of R nicely. There are a few packages available for generating simple summary statistics tables that contain information about the central tendencies and dispersion of the data that also export nicely, such as `gtsummary`.\n\n```{r, eval = FALSE}\nlibrary(gtsummary)\n\n# tbl_summary() creates a summary table of the data\ntbl_summary(diamonds)\n```\n\nYou can stratify your summary by a grouping variable using the `by` argument:\n\n```{r, eval = FALSE}\ntbl_summary(diamonds, by = cut)\n\n# add p-value of difference between groups\ntbl_summary(diamonds, by = cut) |> \n  add_p()\n```\n\nYou can also customize the appearance of the table.\n\n```{r, eval = FALSE}\ntbl_summary(diamonds, by = cut) |> \n  modify_header(label ~ \"Variable\") |> \n  modify_caption(\"Summary Table by Cut\")\n```\n\nTo export the table as a Word document, use the `gtsave()` function. Note that we first use the `as_gt()` function to convert the `tbl_summary()` output to a `gt` object, and load the `gt` package in order to use the Word export function defined for the `gt` package.\n\n```{r, eval=FALSE}\nlibrary(gt)\n\ntbl_summary(diamonds, by = cut) |> \n  as_gt() |> \n  gtsave(\"summary_table.docx\")\n```\n\nIf you use LaTeX, you can also export as a LaTeX table, also relying on the `gt` package.\n\n```{r, eval=FALSE}\ntbl_summary(diamonds, by = cut) |> \n  as_gt() |> \n  gtsave(\"summary_table.tex\")\n```\n\n# Hypothesis testing\n\nMost of the simple statistical tests are from base R, so they don't rely on tidy principles, but many are compatible with tidy workflows to at least some extent. In the following we'll cover some of the key methods that show up in methods and statistics courses at UCR. In addition, the `tidy()` function from the `broom` package converts most text output into simple tibbles, which are useful for exporting and visualizing results.\n\n```{r, eval = FALSE}\nlibrary(broom)\n```\n\n## t-tests\n\nWe can run one and two samples t-tests to evaluate group means with the `t.test()` function. The function supports various options and model specifications: a simple one-sample t-test only requires specifying the variable of interest, either with `x = data$variable` or `x = variable, data = data` syntax. For two-sample t-tests, we can use the formula syntax `y ~ x` to specify the dependent and independent variables or the `x` and `y` (and optionally `data`) arguments. Additional options include specifying the alternative hypothesis, the confidence level, the value of $\\mu$, and whether we want a paired t-test and assume equal variances. Helper functions such as `tidy()` convert the Console output to an easy-to-export tibble of results.\n\nTo demonstrate two-sample t-tests, we define a subset of the data that contains only two possible values of `cut`.\n\n```{r, eval = FALSE}\n# simple t-test (H0: mean=mu)\nt.test(diamonds$carat, mu = 1)\n\n# define data subsample of fair and good diamonds to have only two groups of cut\ndiamonds_sub <- diamonds |> \n  filter(cut %in% c(\"Fair\", \"Good\"))\n\n# can also use data argument instead of data$...\n# price ~ cut is formula specification: variable ~ group\n# H0: fair and good diamonds have the same average price\nt.test(price ~ cut, alternative = \"greater\", data = diamonds_sub)\n\n# tidy() function turns results into a tibble\nt.test(price ~ cut, alternative = \"greater\", data = diamonds_sub) |> tidy()\n```\n\n## Correlation test\n\nThe `cor.test()` function calculates the correlation between two variables. Again, the function supports various specifications: `x` and `y` arguments, formula syntax (see below for an example), and the `data` argument.\n\n```{r, eval = FALSE}\ncor.test( ~ price + carat, data = diamonds)\n\n# tidy() function turns results into a tibble\ncor.test( ~ price + carat, data = diamonds) |> tidy()\n```\n\n## Simple regression\n\nA key building block of statistical analysis is linear regression. The `lm()` function fits a linear model to the data, with a wide range of specifications, passed as the formula argument (first argument if unnamed). The formula syntax is `y ~ x`, where `y` is the dependent variable and `x` is the independent variable. Again, optional function arguments allow for a lot of customization, but the default settings are sufficient for most applications. Helper functions such as `tidy()` and `summary()` provide extensive summaries of the model fit and coefficients, and `tbl_regression()` from the `gtsummary` package creates neat tables of the results. Assigning the result of a model to an object saves computational time, as then we can work with the results without having to re-run the analysis every time.\n\n```{r, eval = FALSE}\n# assign outcome to object\nfit <- lm(price ~ carat, data = diamonds)\n\n# extensive result summary\nfit |> summary()\n\n# tidy coefficients\nfit |> tidy()\n\n# display-ready table with gtsummary\ntbl_regression(fit)\n```\n\n## Multiple regression\n\nMultiple regression extends simple regression to multiple independent variables. The only difference is the formula specification, which now connects multiple independent variables with `+` signs. The formula specification also allows for interactions between variables, which can be specified with `*` (if the main effects should be included) or `:` (for only the interaction term). The `DV ~ .~` syntax includes all variables in the data except the dependent variable as independent variables.\n\n```{r, eval = FALSE}\nlm(price ~ x + y + z + table + depth, data = diamonds) |> summary()\n\n# all variables in data\nlm(price ~ ., data = diamonds) |> summary()\n\n# interactions\nlm(price ~ x * y, data = diamonds) |> summary()\n```\n\n## ANOVA\n\nAnalysis of variance (ANOVA) is a generalization of the t-test to multiple groups. The `aov()` function fits an ANOVA model to the data, with the formula syntax `y ~ x`, where `y` is the dependent variable and `x` is the independent variable. The same helper functions as with `lm()` can be used to summarize the results.\n\nNote that ANOVA is a specific case of a linear regression model, so the results are equivalent to those of a linear regression model with a categorical independent variable.\n\n```{r, eval = FALSE}\nanova_fit <- aov(price ~ cut, data = diamonds)\n\nsummary(anova_fit)\ntidy(anova_fit)\n\n# equivalent regression\nlm(price ~ cut, data = diamonds) |> summary()\n```\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../styles.css"],"toc":true,"output-file":"r_stats.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.555","editor":"visual","theme":"simplex","mainfont":"Cormorant SC","fontsize":"20px","layout":"page","title":"Statistics in R","date":"Last updated: `r Sys.Date()`"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}