{"title":"SSCPOLI302:<br> Analysis of a legislative dossier","markdown":{"yaml":{"layout":"page","title":"SSCPOLI302:<br> Analysis of a legislative dossier","subtitle":"Fall 2024","date":"Last updated: `r Sys.Date()`"},"headingText":"Loading the data","containsRefs":false,"markdown":"\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, error = FALSE)\n```\n\n\nOnce you have cleaned the data, you can start analyzing it in R. Below is a template for the analysis using for the dossier 2022/0396(COD), which is regulating packaging and packaging waste. Our cleaned data is stored in our project directory and is called \"2022_0396_COD_clean.xlsx\".\n\nIn this first code chunk, you only need to change the file name and the dossier reference (see comments) to match your data. This code will load the meeting data, filter it for the dossier of interest, load the cleaned list of attendees, and combine the two datasets. So in the data we will have not only the meetings related to the dossier 2022/0396(COD) as declared in the original data, but also the standardized attendee names and categories.\n\n```{r}\n# load the necessary libraries (install if needed)\nlibrary(tidyverse)\nlibrary(rio)\n\n# import meeting data\nmeetings_raw <- import(\"https://github.com/ucrdatacenter/projects/raw/main/SSCPOLI302/2024h2/meetings_per_attendee.xlsx\", setclass = \"tbl_df\") |>\n  mutate(meeting_date = as.Date(meeting_date)) |>\n  drop_na(procedure_reference)\n\n# import attendee data from packaging waste file\nattendees <- import(\"https://github.com/ucrdatacenter/projects/raw/main/SSCPOLI302/2024h2/attendees/2022_0396_COD_clean.xlsx\", setclass = \"tbl_df\")\n# import your own data from the file you copied into your Project Folder\n# attendees <- import(\"YourFileName.xlsx\", setclass = \"tbl_df\")\n\n# retain data for your dossier, then merge with attendee data\nmeetings <- meetings_raw |>\n  filter(procedure_reference == \"2022/0396(COD)\") |>\n  left_join(attendees, by = \"attendees\")\n```\n\nTo help make our figures, we can define some additional political groups characteristics. We will use this information to color our plots and to order the political groups in the plots.\n\n```{r}\n# assigning colors and names\nseats <- tribble(\n  ~political_group, ~seats, ~leftright, ~color, ~longname,\n  \"the Left\", 37, 1, \"firebrick\", \"The Left in the European Parliament (GUE/NGL)\",\n  \"Greens\", 70, 2, \"forestgreen\", \"Greens/European Free Alliance\",\n  \"S&D\", 138, 3, \"red\", \"Progressive Alliance of Socialists and Democrats\",\n  \"Renew\", 98, 4, \"deepskyblue\", \"Renew Europe\",\n  \"EPP\", 179, 5, \"royalblue\", \"European People's Party\",\n  \"ECR\", 69, 6, \"darkorange\", \"European Conservatives and Reformists\",\n  \"ID\", 49, 7, \"navy\", \"Identity and Democracy\",\n  \"Non-attached\", 63, 8, \"gray\", \"Non-attached Members\"\n)\n```\n\n# Exploring meeting distributions\n\n```{r}\n# number of meetings per political group\nmeetings |>\n  count(political_group) |>\n  left_join(seats) |>\n  ggplot(\n    aes(x = reorder(political_group, leftright), y = n, fill = color)\n  ) +\n  geom_col() +\n  scale_fill_identity()\n```\n\n```{2}\n#\tnumber of meetings per seat per political group\nmeetings |>\n  count(political_group) |>\n  left_join(seats) |>\n  mutate(meetings_per_seat = n / seats) |>\n  ggplot(\n    aes(x = reorder(political_group, leftright), y = meetings_per_seat, fill = color)\n  ) +\n  geom_col() + scale_fill_identity()\n```\n\n```{r}\n#\tnumber of meetings by MEP-role\nmeetings |>\n  count(member_capacity) |>\n  ggplot(\n    aes(x = member_capacity, y = n)\n  ) +\n  geom_col()\n```\n\n```{r}\n# number of meetings by MEP-role and by political group\nmeetings |>\n  count(member_capacity, political_group) |>\n  left_join(seats) |>\n  ggplot(\n    aes(x = reorder(political_group,leftright), y = n, fill = member_capacity)\n  ) +\n  geom_col()\n```\n\n```{r}\n# number of meetings by organization type\nmeetings |>\n  count(class) |>\n  ggplot(\n    aes(x = class, y = n)\n  ) +\n  geom_col()\n```\n\n```{r}\n# number of organizations by political group\nmeetings |>\n  count(political_group, fixed_names) |>\n  count(political_group) |>\n  left_join(seats) |>\n  ggplot(\n    aes(x = reorder(political_group, leftright), y = n)\n  ) +\n  geom_col()\n```\n\n```{r}\n# number of meetings by political group and by class\nmeetings |>\n  count(class, political_group, sort = T) |>\n  left_join(seats) |>\n  ggplot(\n    aes(x = reorder(political_group,leftright), y = n, fill = class)\n  ) +\n  geom_col()\n```\n\n```{r}\n# number of organizations by political group and by class\nmeetings |>\n  count(class, political_group, fixed_names, sort = T) |>\n  count(class, political_group) |>\n  left_join(seats) |>\n  ggplot(\n    aes(x = reorder(political_group,leftright), y = n, fill = class)\n  ) +\n  geom_col()\n```\n\n# Finding the most active MEPs and organizations\n\n```{r}\n# number of contacts per fixed_name by political group\norgxgroups <- meetings |>\n  count(political_group, fixed_names) |>\n  group_by(fixed_names) |>\n  mutate(total_meetings = sum(n)) |>\n  pivot_wider(names_from = political_group, values_from = n) |>\n  arrange(desc(total_meetings))\n```\n\n```{r}\n# list individual MEPs with most meetings and their political group and roles and distribution over type\nranked_meps <- meetings |>\n  count(member_name, member_capacity, political_group, name = \"number_of_meetings\") |>\n  left_join(\n    meetings |>\n      filter(class == \"NGO\") |>\n      count(member_name, member_capacity, name = \"ngo_meetings\"),\n    by = c(\"member_name\", \"member_capacity\")\n  ) |>\n  left_join(\n    meetings |>\n      filter(class == \"business\") |>\n      count(member_name, member_capacity, name = \"business_meetings\"),\n    by = c(\"member_name\", \"member_capacity\")\n  ) |>\n  replace_na(list(ngo_meetings = 0, business_meetings = 0)) |>\n  arrange(desc(number_of_meetings))\n```\n\n```{r}\n# alternative code with the same result\nranked_meps <- meetings |>\n  drop_na(class) |>\n  group_by(country, member_capacity, political_group, member_id, member_name) |>\n  summarize(\n    business = sum(class == \"business\"),\n    ngo = sum(class == \"NGO\"),\n    total = n()\n  ) |>\n  arrange(desc(total))\n```\n\n```{r}\n# showing meetings for a specific interest group (McDonalds)\nmeetings |>\n  filter(str_detect(fixed_names, \"Donal\")) |>\n  count(political_group, member_capacity) |>\n  left_join(seats) |>\n  ggplot(\n    aes(x = reorder(political_group,leftright), y = n, fill = member_capacity)\n  ) +\n  geom_col()\n```\n\n\\`\\`\\`{r} \\# timing of meetings by MEP role meetings \\|\\> mutate(meeting_date = floor_date(meeting_date, unit = \"months\")) \\|\\> count(member_capacity, meeting_date) \\|\\> ggplot( aes(x = meeting_date, y = n, fill = member_capacity) ) + geom_col()\n","srcMarkdownNoYaml":"\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, error = FALSE)\n```\n\n# Loading the data\n\nOnce you have cleaned the data, you can start analyzing it in R. Below is a template for the analysis using for the dossier 2022/0396(COD), which is regulating packaging and packaging waste. Our cleaned data is stored in our project directory and is called \"2022_0396_COD_clean.xlsx\".\n\nIn this first code chunk, you only need to change the file name and the dossier reference (see comments) to match your data. This code will load the meeting data, filter it for the dossier of interest, load the cleaned list of attendees, and combine the two datasets. So in the data we will have not only the meetings related to the dossier 2022/0396(COD) as declared in the original data, but also the standardized attendee names and categories.\n\n```{r}\n# load the necessary libraries (install if needed)\nlibrary(tidyverse)\nlibrary(rio)\n\n# import meeting data\nmeetings_raw <- import(\"https://github.com/ucrdatacenter/projects/raw/main/SSCPOLI302/2024h2/meetings_per_attendee.xlsx\", setclass = \"tbl_df\") |>\n  mutate(meeting_date = as.Date(meeting_date)) |>\n  drop_na(procedure_reference)\n\n# import attendee data from packaging waste file\nattendees <- import(\"https://github.com/ucrdatacenter/projects/raw/main/SSCPOLI302/2024h2/attendees/2022_0396_COD_clean.xlsx\", setclass = \"tbl_df\")\n# import your own data from the file you copied into your Project Folder\n# attendees <- import(\"YourFileName.xlsx\", setclass = \"tbl_df\")\n\n# retain data for your dossier, then merge with attendee data\nmeetings <- meetings_raw |>\n  filter(procedure_reference == \"2022/0396(COD)\") |>\n  left_join(attendees, by = \"attendees\")\n```\n\nTo help make our figures, we can define some additional political groups characteristics. We will use this information to color our plots and to order the political groups in the plots.\n\n```{r}\n# assigning colors and names\nseats <- tribble(\n  ~political_group, ~seats, ~leftright, ~color, ~longname,\n  \"the Left\", 37, 1, \"firebrick\", \"The Left in the European Parliament (GUE/NGL)\",\n  \"Greens\", 70, 2, \"forestgreen\", \"Greens/European Free Alliance\",\n  \"S&D\", 138, 3, \"red\", \"Progressive Alliance of Socialists and Democrats\",\n  \"Renew\", 98, 4, \"deepskyblue\", \"Renew Europe\",\n  \"EPP\", 179, 5, \"royalblue\", \"European People's Party\",\n  \"ECR\", 69, 6, \"darkorange\", \"European Conservatives and Reformists\",\n  \"ID\", 49, 7, \"navy\", \"Identity and Democracy\",\n  \"Non-attached\", 63, 8, \"gray\", \"Non-attached Members\"\n)\n```\n\n# Exploring meeting distributions\n\n```{r}\n# number of meetings per political group\nmeetings |>\n  count(political_group) |>\n  left_join(seats) |>\n  ggplot(\n    aes(x = reorder(political_group, leftright), y = n, fill = color)\n  ) +\n  geom_col() +\n  scale_fill_identity()\n```\n\n```{2}\n#\tnumber of meetings per seat per political group\nmeetings |>\n  count(political_group) |>\n  left_join(seats) |>\n  mutate(meetings_per_seat = n / seats) |>\n  ggplot(\n    aes(x = reorder(political_group, leftright), y = meetings_per_seat, fill = color)\n  ) +\n  geom_col() + scale_fill_identity()\n```\n\n```{r}\n#\tnumber of meetings by MEP-role\nmeetings |>\n  count(member_capacity) |>\n  ggplot(\n    aes(x = member_capacity, y = n)\n  ) +\n  geom_col()\n```\n\n```{r}\n# number of meetings by MEP-role and by political group\nmeetings |>\n  count(member_capacity, political_group) |>\n  left_join(seats) |>\n  ggplot(\n    aes(x = reorder(political_group,leftright), y = n, fill = member_capacity)\n  ) +\n  geom_col()\n```\n\n```{r}\n# number of meetings by organization type\nmeetings |>\n  count(class) |>\n  ggplot(\n    aes(x = class, y = n)\n  ) +\n  geom_col()\n```\n\n```{r}\n# number of organizations by political group\nmeetings |>\n  count(political_group, fixed_names) |>\n  count(political_group) |>\n  left_join(seats) |>\n  ggplot(\n    aes(x = reorder(political_group, leftright), y = n)\n  ) +\n  geom_col()\n```\n\n```{r}\n# number of meetings by political group and by class\nmeetings |>\n  count(class, political_group, sort = T) |>\n  left_join(seats) |>\n  ggplot(\n    aes(x = reorder(political_group,leftright), y = n, fill = class)\n  ) +\n  geom_col()\n```\n\n```{r}\n# number of organizations by political group and by class\nmeetings |>\n  count(class, political_group, fixed_names, sort = T) |>\n  count(class, political_group) |>\n  left_join(seats) |>\n  ggplot(\n    aes(x = reorder(political_group,leftright), y = n, fill = class)\n  ) +\n  geom_col()\n```\n\n# Finding the most active MEPs and organizations\n\n```{r}\n# number of contacts per fixed_name by political group\norgxgroups <- meetings |>\n  count(political_group, fixed_names) |>\n  group_by(fixed_names) |>\n  mutate(total_meetings = sum(n)) |>\n  pivot_wider(names_from = political_group, values_from = n) |>\n  arrange(desc(total_meetings))\n```\n\n```{r}\n# list individual MEPs with most meetings and their political group and roles and distribution over type\nranked_meps <- meetings |>\n  count(member_name, member_capacity, political_group, name = \"number_of_meetings\") |>\n  left_join(\n    meetings |>\n      filter(class == \"NGO\") |>\n      count(member_name, member_capacity, name = \"ngo_meetings\"),\n    by = c(\"member_name\", \"member_capacity\")\n  ) |>\n  left_join(\n    meetings |>\n      filter(class == \"business\") |>\n      count(member_name, member_capacity, name = \"business_meetings\"),\n    by = c(\"member_name\", \"member_capacity\")\n  ) |>\n  replace_na(list(ngo_meetings = 0, business_meetings = 0)) |>\n  arrange(desc(number_of_meetings))\n```\n\n```{r}\n# alternative code with the same result\nranked_meps <- meetings |>\n  drop_na(class) |>\n  group_by(country, member_capacity, political_group, member_id, member_name) |>\n  summarize(\n    business = sum(class == \"business\"),\n    ngo = sum(class == \"NGO\"),\n    total = n()\n  ) |>\n  arrange(desc(total))\n```\n\n```{r}\n# showing meetings for a specific interest group (McDonalds)\nmeetings |>\n  filter(str_detect(fixed_names, \"Donal\")) |>\n  count(political_group, member_capacity) |>\n  left_join(seats) |>\n  ggplot(\n    aes(x = reorder(political_group,leftright), y = n, fill = member_capacity)\n  ) +\n  geom_col()\n```\n\n\\`\\`\\`{r} \\# timing of meetings by MEP role meetings \\|\\> mutate(meeting_date = floor_date(meeting_date, unit = \"months\")) \\|\\> count(member_capacity, meeting_date) \\|\\> ggplot( aes(x = meeting_date, y = n, fill = member_capacity) ) + geom_col()\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../../styles.css"],"toc":true,"output-file":"workshop3.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.555","editor":"visual","theme":"simplex","mainfont":"Cormorant SC","fontsize":"20px","layout":"page","title":"SSCPOLI302:<br> Analysis of a legislative dossier","subtitle":"Fall 2024","date":"Last updated: `r Sys.Date()`"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}