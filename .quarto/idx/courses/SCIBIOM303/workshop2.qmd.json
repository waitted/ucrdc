{"title":"SCIBIOM303 Workshop 2: Temperature and Heatstroke-related Ambulance Dispatches","markdown":{"yaml":{"layout":"page","title":"SCIBIOM303 Workshop 2: Temperature and Heatstroke-related Ambulance Dispatches","subtitle":"Spring 2025","date":"Last updated: `r Sys.Date()`"},"headingText":"Introduction","containsRefs":false,"markdown":"\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE, error=FALSE)\n```\n\n\nIn this encounter, we will explore the relationship between temperature and heatstroke-related ambulance dispatches using data from Japan. The data contains daily records of maximum temperature and relative humidity across all 47 prefectures from 2015 to 2019.\n\n# Loading packages\n\nWe will start by loading the tidyverse and rio packages. Ensure these packages are installed before running the code.\n\n```{r}\n# install.packages(\"tidyverse\")\n# install.packages(\"rio\")\nlibrary(tidyverse)\nlibrary(rio)\n```\n\n# Importing Data\n\nWe will import two data sets: one for heatstroke-related ambulance dispatches (HSAD) and one for temperature data.\n\n```{r}\nhsad <- import(\"https://github.com/ucrdatacenter/projects/raw/refs/heads/main/SCIBIOM303/2025h1/data/HSAD.csv\")\ntemp <- import(\"https://github.com/ucrdatacenter/projects/raw/refs/heads/main/SCIBIOM303/2025h1/data/temperature.csv\")\n```\n\n# Merging the Data\n\nTo analyze the relationship between temperature and heatstroke-related ambulance dispatches, we will merge the two data sets using the left_join() function. We will join them on the columns Date and Prefecture. Next, we convert the Date column into a date format.\n\n```{r}\nmerged <- left_join(temp, hsad, by = c(\"Date\", \"Prefecture\")) |> \n  mutate(Date = dmy(Date)) \n```\n\n# Analyzing Data for a Specific Prefecture and Year\n\nWe will focus on Hiroshima in 2015 to study the relationship between daily maximum temperature and heatstroke-related ambulance dispatches.\n\n```{r}\nhiroshima_2015 <- merged |> \n  filter(Prefecture == \"Hiroshima\") |> \n  filter(Year == 2015)\n```\n\n# Visualizing the Data\n\nWe will create a scatter plot to visualize the relationship between maximum temperature and heatstroke-related ambulance dispatches. A trend line is added to show the overall pattern.\n\n```{r}\nggplot(hiroshima_2015, aes(x = Tempmax, y = HSAD)) +\n  geom_point() +\n  geom_smooth(se = FALSE) +\n  labs(title = \"Temperature and Heatstroke-related Ambulance Dispatches in Hiroshima in 2015\",\n       x = \"Maximum Temperature\",\n       y = \"Heatstroke-related Ambulance Dispatches\") +\n  theme_minimal()\n```\n\nThe number of heatstroke-related ambulance dispatches increases significantly when the temperature exceeds 30°C. This trend aligns with what we expect because higher temperatures can cause a rapid rise in core body temperature, leading to heatstroke ([source](https://www.mayoclinic.org/diseases-conditions/heat-stroke/symptoms-causes/syc-20353581)).\n\n# Trends Over Time\n\nWe will create another plot to show how maximum temperature changes over time in Hiroshima in 2015.\n\n```{r}\nggplot(hiroshima_2015, aes(x = Date, y = Tempmax)) +\n  geom_point() +\n  geom_smooth(se = FALSE) +\n  labs(title = \"Temperature Over Time in Hiroshima in 2015\",\n       x = \"Date\",\n       y = \"Maximum Temperature\") +\n  theme_minimal()\n```\n\nThe temperature rises in June, peaks in August (above 35°C), and then decreases in October. This seasonal pattern is typical for Hiroshima ([source](https://www.climatestotravel.com/climate/japan/hiroshima)).\n\n# Linear Regression Analysis\n\nTo quantify the relationship between temperature and heatstroke-related ambulance dispatches, we perform a linear regression analysis.\n\n```{r}\nlr <- lm(HSAD ~ Tempmax, data = hiroshima_2015)\nsummary(lr)\n```\n\nThe R-squared value of 0.6193 indicates that about 61.93% of the variability in ambulance dispatches can be explained by the maximum temperature. This suggests a strong positive relationship between HSAD and temperature.\n\n# Comparing Two Prefectures\n\nNext, we will compare the relationship between temperature and ambulance dispatches in Hiroshima and Kyoto in 2015 using a line graph.\n\n```{r}\nmerged |> \n  filter(Prefecture == \"Kyoto\"| Prefecture == \"Hiroshima\") |> \n  filter(Year == 2015) |> \n  ggplot() +\n  geom_smooth(aes(x = Tempmax, y = HSAD, color = Prefecture), se = FALSE) +\n  labs(title = \"Temperature and Heatstroke-related Ambulance Dispatches (2015)\",\n       x = \"Maximum Temperature\",\n       y = \"Heatstroke-related Ambulance Dispatches\") +\n  theme_minimal()\n```\n\nBoth prefectures show similar trends, with the number of dispatches increasing as temperature rises ([source](https://doi.org/10.3961/jpmph.2012.45.5.309)).\n\n# Dispatches by Day of the Week\n\nWe can also analyze the average number of dispatches by the day of the week.\n\n```{r}\nhiroshima_2015 |>\n  group_by(Dow) |>\n  summarize(HSAD = mean(HSAD)) |>\n  ggplot(aes(x = Dow, y = HSAD)) +\n  geom_col() +\n  labs(title = \"Heatstroke-related Ambulance Dispatches by Day of the Week (2015)\",\n       x = \"Day of the week\",\n       y = \"Heatstroke-related Ambulance Dispatches\") +\n  theme_minimal()\n```\n\nThere are more dispatches on days 1 and 7, which correspond to Sunday and Saturday, respectively. This is expected, as heatstroke cases are more frequent on weekends, especially on Sundays when people engage in outdoor or sporting activities ([source](https://www.channelnewsasia.com/today/ground-up/heatstroke-heat-related-illnesses-dangers-risks-take-precautions-misconceptions-4647621)).\n\n# Creating the Heat Index\n\nThe heat index, also known as the \"feels-like\" temperature, is calculated using temperature and humidity to reflect how hot it feels to the human body. This formula was developed by Robert G. Steadman in 1979 and later adapted by the National Weather Service. It accounts for the reduced ability of the body to cool itself through sweating in high-humidity conditions, making it a crucial indicator for heat-related health risks ([source](https://www.weather.gov/ama/heatindex)).\n\nWe first convert the temperature to Fahrenheit to calculate the heat index, then convert it back to Celsius.\n\n```{r}\nhiroshima_lr_data <- hiroshima_2015 %>%\n  mutate(\n    Temp_F = Tempmax * 9 / 5 + 32,\n    Heat_Index_F = -42.379 + \n      2.04901523 * Temp_F + \n      10.14333127 * Rhumave - \n      0.22475541 * Temp_F * Rhumave - \n      0.00683783 * Temp_F^2 - \n      0.05481717 * Rhumave^2 + \n      0.00122874 * Temp_F^2 * Rhumave + \n      0.00085282 * Temp_F * Rhumave^2 - \n      0.00000199 * Temp_F^2 * Rhumave^2,\n    Heat_Index_C = (Heat_Index_F - 32) * 5 / 9)\n```\n\n# Visualizing Heat Index and Ambulance Dispatches\n\nWe will create a plot to show the relationship between the heat index and ambulance dispatches.\n\n```{r}\nggplot(hiroshima_lr_data, aes(x = Heat_Index_C, y = HSAD)) +\n  geom_point() +\n  geom_smooth(se = FALSE) +\n  labs(title = \"Heat Index and Heatstroke-related Ambulance Dispatches in Hiroshima in 2015\",\n       x = \"Heat Index\",\n       y = \"Heatstroke-related Ambulance Dispatches\") +\n  theme_minimal()\n```\n\nThe number of dispatches rises sharply after the heat index exceeds 30°C, confirming that the heat index is a strong predictor of heat-related emergencies ([source](https://doi.org/10.1186/s40779-015-0056-z)).\n\n# Linear Regression with Heat Index\n\nFinally, we perform a linear regression analysis using the heat index to predict ambulance dispatches.\n\n```{r}\nlr2 <- lm(HSAD ~ Heat_Index_C, data = hiroshima_lr_data)\nsummary(lr2)\n```\n\nThe R-squared value is 0.7222, meaning that 72.22% of the variability in dispatches can be explained by the heat index. This suggests the heat index is an even stronger predictor than temperature alone.\n","srcMarkdownNoYaml":"\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE, error=FALSE)\n```\n\n# Introduction\n\nIn this encounter, we will explore the relationship between temperature and heatstroke-related ambulance dispatches using data from Japan. The data contains daily records of maximum temperature and relative humidity across all 47 prefectures from 2015 to 2019.\n\n# Loading packages\n\nWe will start by loading the tidyverse and rio packages. Ensure these packages are installed before running the code.\n\n```{r}\n# install.packages(\"tidyverse\")\n# install.packages(\"rio\")\nlibrary(tidyverse)\nlibrary(rio)\n```\n\n# Importing Data\n\nWe will import two data sets: one for heatstroke-related ambulance dispatches (HSAD) and one for temperature data.\n\n```{r}\nhsad <- import(\"https://github.com/ucrdatacenter/projects/raw/refs/heads/main/SCIBIOM303/2025h1/data/HSAD.csv\")\ntemp <- import(\"https://github.com/ucrdatacenter/projects/raw/refs/heads/main/SCIBIOM303/2025h1/data/temperature.csv\")\n```\n\n# Merging the Data\n\nTo analyze the relationship between temperature and heatstroke-related ambulance dispatches, we will merge the two data sets using the left_join() function. We will join them on the columns Date and Prefecture. Next, we convert the Date column into a date format.\n\n```{r}\nmerged <- left_join(temp, hsad, by = c(\"Date\", \"Prefecture\")) |> \n  mutate(Date = dmy(Date)) \n```\n\n# Analyzing Data for a Specific Prefecture and Year\n\nWe will focus on Hiroshima in 2015 to study the relationship between daily maximum temperature and heatstroke-related ambulance dispatches.\n\n```{r}\nhiroshima_2015 <- merged |> \n  filter(Prefecture == \"Hiroshima\") |> \n  filter(Year == 2015)\n```\n\n# Visualizing the Data\n\nWe will create a scatter plot to visualize the relationship between maximum temperature and heatstroke-related ambulance dispatches. A trend line is added to show the overall pattern.\n\n```{r}\nggplot(hiroshima_2015, aes(x = Tempmax, y = HSAD)) +\n  geom_point() +\n  geom_smooth(se = FALSE) +\n  labs(title = \"Temperature and Heatstroke-related Ambulance Dispatches in Hiroshima in 2015\",\n       x = \"Maximum Temperature\",\n       y = \"Heatstroke-related Ambulance Dispatches\") +\n  theme_minimal()\n```\n\nThe number of heatstroke-related ambulance dispatches increases significantly when the temperature exceeds 30°C. This trend aligns with what we expect because higher temperatures can cause a rapid rise in core body temperature, leading to heatstroke ([source](https://www.mayoclinic.org/diseases-conditions/heat-stroke/symptoms-causes/syc-20353581)).\n\n# Trends Over Time\n\nWe will create another plot to show how maximum temperature changes over time in Hiroshima in 2015.\n\n```{r}\nggplot(hiroshima_2015, aes(x = Date, y = Tempmax)) +\n  geom_point() +\n  geom_smooth(se = FALSE) +\n  labs(title = \"Temperature Over Time in Hiroshima in 2015\",\n       x = \"Date\",\n       y = \"Maximum Temperature\") +\n  theme_minimal()\n```\n\nThe temperature rises in June, peaks in August (above 35°C), and then decreases in October. This seasonal pattern is typical for Hiroshima ([source](https://www.climatestotravel.com/climate/japan/hiroshima)).\n\n# Linear Regression Analysis\n\nTo quantify the relationship between temperature and heatstroke-related ambulance dispatches, we perform a linear regression analysis.\n\n```{r}\nlr <- lm(HSAD ~ Tempmax, data = hiroshima_2015)\nsummary(lr)\n```\n\nThe R-squared value of 0.6193 indicates that about 61.93% of the variability in ambulance dispatches can be explained by the maximum temperature. This suggests a strong positive relationship between HSAD and temperature.\n\n# Comparing Two Prefectures\n\nNext, we will compare the relationship between temperature and ambulance dispatches in Hiroshima and Kyoto in 2015 using a line graph.\n\n```{r}\nmerged |> \n  filter(Prefecture == \"Kyoto\"| Prefecture == \"Hiroshima\") |> \n  filter(Year == 2015) |> \n  ggplot() +\n  geom_smooth(aes(x = Tempmax, y = HSAD, color = Prefecture), se = FALSE) +\n  labs(title = \"Temperature and Heatstroke-related Ambulance Dispatches (2015)\",\n       x = \"Maximum Temperature\",\n       y = \"Heatstroke-related Ambulance Dispatches\") +\n  theme_minimal()\n```\n\nBoth prefectures show similar trends, with the number of dispatches increasing as temperature rises ([source](https://doi.org/10.3961/jpmph.2012.45.5.309)).\n\n# Dispatches by Day of the Week\n\nWe can also analyze the average number of dispatches by the day of the week.\n\n```{r}\nhiroshima_2015 |>\n  group_by(Dow) |>\n  summarize(HSAD = mean(HSAD)) |>\n  ggplot(aes(x = Dow, y = HSAD)) +\n  geom_col() +\n  labs(title = \"Heatstroke-related Ambulance Dispatches by Day of the Week (2015)\",\n       x = \"Day of the week\",\n       y = \"Heatstroke-related Ambulance Dispatches\") +\n  theme_minimal()\n```\n\nThere are more dispatches on days 1 and 7, which correspond to Sunday and Saturday, respectively. This is expected, as heatstroke cases are more frequent on weekends, especially on Sundays when people engage in outdoor or sporting activities ([source](https://www.channelnewsasia.com/today/ground-up/heatstroke-heat-related-illnesses-dangers-risks-take-precautions-misconceptions-4647621)).\n\n# Creating the Heat Index\n\nThe heat index, also known as the \"feels-like\" temperature, is calculated using temperature and humidity to reflect how hot it feels to the human body. This formula was developed by Robert G. Steadman in 1979 and later adapted by the National Weather Service. It accounts for the reduced ability of the body to cool itself through sweating in high-humidity conditions, making it a crucial indicator for heat-related health risks ([source](https://www.weather.gov/ama/heatindex)).\n\nWe first convert the temperature to Fahrenheit to calculate the heat index, then convert it back to Celsius.\n\n```{r}\nhiroshima_lr_data <- hiroshima_2015 %>%\n  mutate(\n    Temp_F = Tempmax * 9 / 5 + 32,\n    Heat_Index_F = -42.379 + \n      2.04901523 * Temp_F + \n      10.14333127 * Rhumave - \n      0.22475541 * Temp_F * Rhumave - \n      0.00683783 * Temp_F^2 - \n      0.05481717 * Rhumave^2 + \n      0.00122874 * Temp_F^2 * Rhumave + \n      0.00085282 * Temp_F * Rhumave^2 - \n      0.00000199 * Temp_F^2 * Rhumave^2,\n    Heat_Index_C = (Heat_Index_F - 32) * 5 / 9)\n```\n\n# Visualizing Heat Index and Ambulance Dispatches\n\nWe will create a plot to show the relationship between the heat index and ambulance dispatches.\n\n```{r}\nggplot(hiroshima_lr_data, aes(x = Heat_Index_C, y = HSAD)) +\n  geom_point() +\n  geom_smooth(se = FALSE) +\n  labs(title = \"Heat Index and Heatstroke-related Ambulance Dispatches in Hiroshima in 2015\",\n       x = \"Heat Index\",\n       y = \"Heatstroke-related Ambulance Dispatches\") +\n  theme_minimal()\n```\n\nThe number of dispatches rises sharply after the heat index exceeds 30°C, confirming that the heat index is a strong predictor of heat-related emergencies ([source](https://doi.org/10.1186/s40779-015-0056-z)).\n\n# Linear Regression with Heat Index\n\nFinally, we perform a linear regression analysis using the heat index to predict ambulance dispatches.\n\n```{r}\nlr2 <- lm(HSAD ~ Heat_Index_C, data = hiroshima_lr_data)\nsummary(lr2)\n```\n\nThe R-squared value is 0.7222, meaning that 72.22% of the variability in dispatches can be explained by the heat index. This suggests the heat index is an even stronger predictor than temperature alone.\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"toc":true,"output-file":"workshop2.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.555","editor":"visual","theme":"simplex","mainfont":"Cormorant SC","fontsize":"20px","layout":"page","title":"SCIBIOM303 Workshop 2: Temperature and Heatstroke-related Ambulance Dispatches","subtitle":"Spring 2025","date":"Last updated: `r Sys.Date()`"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}